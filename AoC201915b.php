<?php

$input = ("
# # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # #
# . . . . . . . . . . . # . . . . . . . . . # . . . . . . . . . # . . . . . . . #
# . # # # # # . # # # # # . # # # # # # # . # # # . # . # # # # # . # # # . # . #
# . # . . . . . # . . . . . # . . . . . # . . . # . # . . . . . . . . . # . # . #
# . # . # # # # # . # # # # # # # . # . # # # . # . # # # # # # # # # . # . # # #
# . # . # . . . . . # . # . . . . . # . # . . . # . . . . . # . . . # . # . . . #
# . # # # . # # # # # . # . # . # # # # # . # # # # # # # # # . # . # # # # # . #
# . # . . . # . # . . . # . # . . . . . # . . . . . # . . . . . # . . . . . . . #
# . # . # # # . # . # . # . # # # # # . # # # # # . # . # # # # # . # # # # # . #
# . # . # O # . . . # . # . # . . . # . # . . . . . # . . . . . # . # . . . # . #
# . # . # . # . # # # . # . # # # . # . # . # # # # # . # # # . # # # . # . # . #
# . . . # . . . . . # . . . . . . . # . # . # . . . . . . . # . . . . . # . # . #
# . # # # . # # # # # # # # # # # # # . # . # # # # # # # . # # # # # # # . # . #
# . # . . . # . . . . . . . . . . . # . # . . . . . # . # . . . . . # . . . # . #
# . # # # . # . # . # # # # # # # . # . # # # # # . # . # # # . # # # . # # # . #
# . . . # . # . # . # . . . # . # . . . # . . . . . # . . . . . # . . . # . # . #
# # # . # . # . # # # . # . # . # # # . # . # # # # # # # . # # # . # # # . # . #
# . . . # . # . . . . . # . # . . . . . # . . . # . . . # . # . . . # . . . # . #
# . # # # # # . # # # # # . # # # # # # # . # . # . # . # . # . # # # # # . # . #
# . . . . . # . # . . . . . # . . . . . # . # . . . # . # . # . # . . . . . # . #
# # # # # . # . # . # . # # # . # # # . # # # . # # # . # # # . # . # # # # # . #
# . # . . . # . # . # . # . . . # . # . . . # . # . # . . . # . # . # . . . . . #
# . # . # # # # # . # # # . # # # . # # # # # . # . # # # . # . # . # . # # # # #
# . # . . . . . . . # . . . # . . . # . . . . . # . # . . . # . # . . . . . . . #
# . # # # # # # # . # . # # + # # . # . # # # # # . # . # # # . # # # # # # # . #
# . # . . . . . # . # . . . # . . . # . # . . . . . # . # . . . . . # . . . # . #
# . # . # . # # # . # # # . # . # # # . # # # # # . # . # # # # # . # . # # # . #
# . # . # . . . . . # . # . # . . . . . . . . . . . # . # . . . . . # . . . . . #
# . # . # # # # # # # . # . # # # # # # # # # . # # # . # . # # # # # # # . # # #
# . . . # . . . . . # . # . . . . . # . . . . . # . . . # . . . . . . . # . . . #
# . # # # # # . # . # . # # # # # . # # # # # # # . # # # . # # # # # . # # # . #
# . # . . . . . # . # . # . . . # . . . . . . . . . # . . . # . . . # . # . . . #
# . # # # . # # # . # . # . # . # # # # # # # # # # # # # . # # # . # . # . # # #
# . . . # . # . # . # . . . # . . . . . # . . . . . . . # . # . . . # . # . # . #
# # # . # . # . # . # . # # # # # . # # # . # . # # # . # . # . # . # . # . # . #
# . # . # . # . . . # . . . . . # . . . . . # . # . . . # . . . # . # . # . # . #
# . # . # . # . # # # # # # # . # # # # # # # . # # # . # # # # # . # . # . # . #
# . . . # . # . . . # . . . . . . . # . . . # . . . # . # . . . # . # . # . . . #
# . # # # . # # # . # # # # # # # # # . # . # # # . # . # . # . # # # . # # # . #
# . . . . . # . . . . . . . . . . . . . # . . . . . # . . . # . . . . . # . . . #
# # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # #");

$input = str_replace(" ", "", $input);

$inputArray = explode("\n",$input);

$grid = array();
$totalDots = 0;

foreach($inputArray as $key => $value) {
    $items = str_split($value);
    foreach($items as $key2 => $value2) {
        $grid[$key][$key2] = $value2;
        if($value2=='.') {
            $totalDots++;
        }
    }
}


echo "$totalDots<br>";


printGrid($grid);
$iterations = 0;

while($totalDots > 0) {

spreadOxygen($grid,$totalDots);
$iterations++;
}

echo "<br>Oxygen spread to all areas after $iterations minutes<Br>";


printGrid($grid);
echo "$totalDots<br>";



function spreadOxygen(&$grid,&$totalDots) {
    foreach($grid as $rowID => $rowColumn) {
        foreach ($rowColumn as $columnID => $gridData){
            if($gridData=="O") {
              $left = $grid[$rowID][$columnID-1];
              $right = $grid[$rowID][$columnID+1];
              $top = $grid[$rowID-1][$columnID];
              $bottom = $grid[$rowID+1][$columnID];
              if($left=='.') {
                $grid[$rowID][$columnID-1] = 'O';
                $totalDots--;
              }
              if($right=='.') {
                $grid[$rowID][$columnID+1] = 'O';
                $totalDots--;
              }
              if($top=='.') {
                $grid[$rowID-1][$columnID] = 'O';
                $totalDots--;
              }
              if($bottom=='.') {
                $grid[$rowID+1][$columnID] = 'O';
                $totalDots--;
              }
              
            }
        }
    }
    return $totalDots;
}



function printGrid($trackGridInputArray) {
    echo '<code>';
    foreach($trackGridInputArray as $rowID => $rowColumn) {
        foreach ($rowColumn as $columnID => $gridData){
            if($gridData==" ") $gridData = "&nbsp;";
            echo "$gridData ";
        }
        echo "<br>";
    }
    echo '</code>';
}
